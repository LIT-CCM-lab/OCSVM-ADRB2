# OCSVM-ADRB2
## Description
The repository contains the code and scripts to reproduce the results obtained in the paper "One class classification for the detection of β2 adrenergic receptor agonists using single-ligand dynamic interaction data".

The scripts can be used to develop new models based on the same methodology.

The presented method uses the description of protein-ligand interactions as interaction pseudo-atoms (IPA) to rescore poses ([J. Chem. Inf. Model. 2013, 53, 3, 623–637](https://pubs.acs.org/doi/10.1021/ci300566n)).
## Requirements
1. Interaction detection requires a working installation of [IChem 5.2.9](http://bioinfo-pharma.u-strasbg.fr/labwebsite/download.html)
2. A Linux/POSIX operating system
3. Python 3 with the required dependencies and additional packages installed (see Install)

## Install (Linux/POSIX)
The installation package contains:
* The _conda\_environemnt.yaml_ file containing the dependencies
* The additional python packages required for the scripts
* The python scripts necessary to reproduce the paper's results
### Installation using conda
1. Download the install package
``` bash
$ git clone https://github.com/LIT-CCM-lab/OCSVM-ADRB2.git
$ cd OCSVM-ADRB2/
```
2. Indicate the location of IChem
Open the file _pyichem_/_pyichem_/_software\_path.yml_ and indicate where the desired executable version of IChem is located, an alias can also be indicated.
3. Create a python virtual environment
Using Conda/Anaconda:
```bash
$ conda env create -n ocsvm_adrb2 -f conda_environment.yml
$ conda activate ocsvm_adrb2
```
4. Install the additional python packages
```bash
(ocsvm_adrb2) $ pip install mol2_trajectory/
(ocsvm_adrb2) $ pip install pyichem/
(ocsvm_adrb2) $ pip install ocsvm_training/
```
5. Test installation
```bash
(ocsvm_adrb2) $ python -c "import mol2_trajectory"
(ocsvm_adrb2) $ python -c "import pyichem"
(ocsvm_adrb2) $ python -c "import ocsvm_training"
```

## How to use
Before using the scripts for either testing or application it is necessary to activate the _ocsvm\_adrb2_ conda environment.
### Testing
Update the _test.sh_ file with the location of the topology, trajectory, and _.pdb_ file to use for model building, and the location of the docking-poses' interactions.
The _test.sh_ script can handle multiple trajectories with the same topology file, and a single file containing docking poses' interactions.

**Outputs**
* _ichem\_outputs/structures/ligand_, folder containing the _.mol2_ file with the ligand structure
* _ichem\_outputs/structures/receptor_, folder containing the _.mol2_ file with the receptor structure
* _ichem\_outputs/interactions_, folder containing the _.mol2_ file with the IPA
* _ichem\_outputs/IFP_, folder containing the raw _ligands.ifp_ file generated by IChem
* _ifp.csv_, file containing the binary interaction fingerprints observed during the simulation
* _ifp\_map.csv_, file containing the ligand and structure files corresponding to the different IFP
* _interactions\_map.csv_, file containing the input and output file of the IPA. It is used as input for the _training.py_ script
* _interactions\_map\_newhyd.csv_, file containing the input and output file of the IPA with the stricter definition of hydrophobic contacts. It is used as input for the _training.py_ script
* _mad\_kernel\_newhyd.sav_, _mad_kernel.sav_, file containing the graph kernel obtained after MAD training
* _qms2\_kernel\_newhyd.sav_, _qms2_kernel.sav_, file containing the graph kernel obtained after QMS2 training
* _mad\_ocsvm\_newhyd.sav_, _mad_ocsvm.sav_, OCSVM models trained using the MAD heuristic
* _qms2\_ocsvm\_newhyd.sav_, _qms2_ocsvm.sav_, OCSVM models trained using the QMS2 heuristic
* _MD\_rescoring\_0.csv_, _MD_rescoring_0_newhyd.csv_, results of rescoring using the MAD trained models
* _MD\_rescoring\_1.csv_, _MD_rescoring_1_newhyd.csv_, results of rescoring using the QMS2 trained models
* _rescoring\_report.txt_, _rescoring_report_newhyd.txt_, report containing the number of selected molecules by each model
* _training\_report.txt_, _training_report_newhyd.txt_, report containing information on the model training
* _trajectory\_conversion\_report.txt_, report containing information on the trajectories converted to _.mol2_ files and possible errors encounetered during conversion
### Usage
1. Use the _trajectory\_converter.py_ script to convert the trajectory file in pairs of _.mol2_ files
2. Use the _compute\_interactions.py_ script to compute the IPA, it is possbile to select between one or both the definitons of hydrophobic contacts
3. Use the _training.py_ script to train the model, it is possbile to select between one or both of the training heuristics
4. Use _scoring.py_ to rescore the IPA files previously obtained from the docking poses
### Supported file formats
The script has been tested with different type of inputs for topology and coordinates file.
- Topology
	- AMBER TOP: .prmtop, .top, parm7
	- CHARMM PSF: .psf
- Coordinate
	- AMBER CRD: .inpcrd
    - AMBER RST: .inprst
    - AMBER TRJ: .trj
    - AMBER NetCDF: .ncdf, .nc
    - CHARMM DCD: .dcd
    - GROMACS XTC: .xtc
    - GROMACS TRR: .trr

The current implementation of the scripts accepts only topologies with atom types from the **AMBER** or **CHARMM** force fields, other force fields (including force fields using SYBYL atom types) are not supported.
Some atom types of the aforementioned force field might not have been implemented in the current version of the script.
## Citation

## Funding
This work was supported by the Agence Nationale de Recherches (ANR) (grant number 2019 CE14 OCHRE to E.K.), Centre National de la Recherche Scientifique (CNRS), Institut du Médicament de Strasbourg (IMS), and Université de Strasbourg